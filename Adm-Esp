local player = game.Players.LocalPlayer
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local tempo = 1.5

if game.CoreGui:FindFirstChild("Lista_De_Admin") then
    game.CoreGui.Lista_De_Admin:Destroy()
end

local function CriarTexto(Parent, nome)
    local Texto = Instance.new("TextLabel")
    Texto.Name = nome
    Texto.BackgroundColor3 = Color3.new(0.196, 0.196, 0.196)
    Texto.TextColor3 = Color3.new(0.882, 0.882, 0.882)
    Texto.TextScaled = true
    Texto.Font = Enum.Font.Arimo
    Texto.Size = UDim2.new(1, 0, 0, 40)
    Texto.Parent = Parent
    Instance.new("UICorner", Texto).CornerRadius = UDim.new(0, 16)
    Instance.new("UITextSizeConstraint", Texto).MaxTextSize = 45
    return Texto
end

local gui = Instance.new("ScreenGui")
gui.Name = "Lista_De_Admin"
gui.ResetOnSpawn = false
gui.Parent = game.CoreGui

local frame = Instance.new("Frame", gui)
frame.BackgroundTransparency = 1
frame.Size = UDim2.new(0.184, 0, 0.349, 0)
frame.Position = UDim2.new(0.775, 0, 0.068, 0)

local scrolling = Instance.new("ScrollingFrame", frame)
scrolling.BackgroundTransparency = 1
scrolling.ScrollBarThickness = 5
scrolling.CanvasSize = UDim2.new(0, 0, 10, 0)
scrolling.AutomaticCanvasSize = Enum.AutomaticSize.Y
scrolling.Size = UDim2.new(1, 0, 0.714, 0)
scrolling.Position = UDim2.new(0, 0, 0.234, 0)
scrolling.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 255)

local UIListLayout = Instance.new("UIListLayout", scrolling)
UIListLayout.Padding = UDim.new(0, 12)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

local header = CriarTexto(frame, "Header")
header.Text = "Lista de admin"
header.Size = UDim2.new(1, 0, 0, 40)

-- Arrastar a janela
do
    local dragging, dragInput, dragStart, startPos
    header.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    header.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- Efeito de cores nos nomes
local cores = {
    Color3.fromRGB(255, 0, 0),
    Color3.fromRGB(0, 255, 0),
    Color3.fromRGB(0, 0, 255),
    Color3.fromRGB(255, 255, 0),
    Color3.fromRGB(255, 0, 255),
    Color3.fromRGB(0, 255, 255),
    Color3.fromRGB(255, 255, 255)
}

task.spawn(function()
    while gui and gui.Parent do
        for _, cor in ipairs(cores) do
            for _, label in ipairs(scrolling:GetChildren()) do
                if label:IsA("TextLabel") and label.Name ~= "Header" then
                    local tween = TweenService:Create(label, TweenInfo.new(tempo, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut), { TextColor3 = cor })
                    tween:Play()
                end
            end
            task.wait(tempo)
        end
    end
end)

-- Atualização da lista de admins
task.spawn(function()
    while gui and gui.Parent do
        local charLocal = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if not charLocal then task.wait(1) continue end

        local adminsOrdenados = {}
        local existentes = {}

        for _, plr in ipairs(game.Players:GetPlayers()) do
            if plr ~= player then
                local leaderstats = plr:FindFirstChild("leaderstats")
                local adminLevel = leaderstats and leaderstats:GetAttribute("Admin")
                local char = plr.Character and plr.Character:FindFirstChild("HumanoidRootPart")

                if adminLevel and adminLevel >= 2 and char then
                    local distancia = math.floor((char.Position - charLocal.Position).Magnitude + 0.5)
                    table.insert(adminsOrdenados, {Player = plr, Distancia = distancia})
                end
            end
        end

        table.sort(adminsOrdenados, function(a, b)
            return a.Distancia < b.Distancia
        end)

        for index, data in ipairs(adminsOrdenados) do
            local nome = data.Player.Name
            local distancia = data.Distancia

            local label = scrolling:FindFirstChild(nome)
            if not label then
                label = CriarTexto(scrolling, nome)
            end

            label.Text = nome .. " - " .. distancia .. "m"
            label.LayoutOrder = index
            existentes[nome] = true
        end

        for _, label in ipairs(scrolling:GetChildren()) do
            if label:IsA("TextLabel") and label.Name ~= "Header" then
                if not existentes[label.Name] then
                    label:Destroy()
                end
            end
        end

        task.wait(1)
    end
end)
